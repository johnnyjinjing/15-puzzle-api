I added some more properties to User and Game models. For User model, I added wins, played_total, and min_move. These are mainly used to track the score of the user. For the 15-puzzle game, it is hard to find a way to give player a score. Currently I am using the number of wins to score the player, and minimum number of move for the ranking purpose. If a player canceled a game before completion, he/she loses the current game. In the game model, board is added to represent the current state of the game. PickleProperty is used here because I need to store a 2D array in the datastore. This representaion of the board makes the movement of the tile easier. In the Game model, I also added history to track the previous moves in the game, and num_move to record the number of movement made in the game. game_over and won are used to indicate if the game is completed and player won the game, respectively. The make_move function will detect illegal move, and raise an exception. Users will be notified by emails if they are games which are not completed. The email will include the rlsafe key strings of the game.
Sometimes the original 15-puzzle may not have solution so the player have to resign. In the later version the game, an automatic player algorithm can be applied to the original board to make sure that the board has a solution. And the score of the game can be determined by the number of movement the player used compared to the automatic solution.